{
   "CVE_data_meta" : {
      "ASSIGNER" : "security@xenproject.org",
      "ID" : "CVE-2022-42334"
   },
   "affects" : {
      "vendor" : {
         "vendor_data" : [
            {
               "product" : {
                  "product_data" : [
                     {
                        "product_name" : "xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_affected" : "?",
                                 "version_value" : "consult Xen advisory XSA-428"
                              }
                           ]
                        }
                     }
                  ]
               },
               "vendor_name" : "Xen"
            }
         ]
      }
   },
   "configuration" : {
      "configuration_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Xen versions 4.11 through 4.17 are vulnerable.  Older versions contain\nthe same functionality, but it is exposed there only via an interface\nwhich is subject to XSA-77's constraints.\n\nOnly x86 systems are potentially vulnerable.  Arm systems are not\nvulnerable.\n\nOnly entities controlling HVM guests can leverage the vulnerability.\nThese are device models running in either a stub domain or de-privileged\nin Dom0."
               }
            ]
         }
      }
   },
   "credit" : {
      "credit_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Aspects of this issue were discovered by Andrew Cooper of XenServer and\nJan Beulich of SUSE."
               }
            ]
         }
      }
   },
   "data_format" : "MITRE",
   "data_type" : "CVE",
   "data_version" : "4.0",
   "description" : {
      "description_data" : [
         {
            "lang" : "eng",
            "value" : "x86/HVM pinned cache attributes mis-handling\n\nT[his CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nTo allow cachability control for HVM guests with passed through devices,\nan interface exists to explicitly override defaults which would\notherwise be put in place.  While not exposed to the affected guests\nthemselves, the interface specifically exists for domains controlling\nsuch guests.  This interface may therefore be used by not fully\nprivileged entities, e.g. qemu running deprivileged in Dom0 or qemu\nrunning in a so called stub-domain.  With this exposure it is an issue\nthat\n - the number of the such controlled regions was unbounded\n   (CVE-2022-42333),\n - installation and removal of such regions was not properly serialized\n   (CVE-2022-42334)."
         }
      ]
   },
   "impact" : {
      "impact_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Entities controlling HVM guests can run the host out of resources or\nstall execution of a physical CPU for effectively unbounded periods of\ntime, resulting in a Denial of Servis (DoS) affecting the entire host.\nCrashes, information leaks, or elevation of privilege cannot be ruled\nout."
               }
            ]
         }
      }
   },
   "problemtype" : {
      "problemtype_data" : [
         {
            "description" : [
               {
                  "lang" : "eng",
                  "value" : "unknown"
               }
            ]
         }
      ]
   },
   "references" : {
      "reference_data" : [
         {
            "url" : "https://xenbits.xenproject.org/xsa/advisory-428.txt"
         }
      ]
   },
   "workaround" : {
      "workaround_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Running only PV or PVH guests will avoid the vulnerability.\n\n(Switching from a device model stub domain or a de-privileged device\nmodel to a fully privileged Dom0 device model does NOT mitigate this\nvulnerability.  Rather, it simply recategorises the vulnerability to\nhostile management code, regarding it \"as designed\"; thus it merely\nreclassifies these issues as \"not a bug\".  The security of a Xen system\nusing stub domains is still better than with a qemu-dm running as a Dom0\nprocess.  Users and vendors of stub qemu dm systems should not change\ntheir configuration to use a Dom0 qemu process.)"
               }
            ]
         }
      }
   }
}
